(* -*- tuareg -*- *)

(* Test file *)

(* include "pervasives.saml" *)
include "builtin.saml"

let id(x) = x

let euler(reset=id,phase=0.,f') =
  let x = ref phase in
  let ans = !x in
  x := !x + dt * f';
  x := reset(!x);
  ans

let sine(freq,phase=0.) = sin(2 * pi * euler(freq,phase=))

let s() = sine(440,phase=0.777)
